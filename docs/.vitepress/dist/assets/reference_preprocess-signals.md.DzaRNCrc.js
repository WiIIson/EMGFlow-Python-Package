import{_ as s,c as e,o as a,ag as t}from"./chunks/framework.DPDPlp3K.js";const g=JSON.parse('{"title":"Signal pre-processing","description":"","frontmatter":{},"headers":[],"relativePath":"reference/preprocess-signals.md","filePath":"reference/preprocess-signals.md","lastUpdated":null}'),n={name:"reference/preprocess-signals.md"};function l(o,i,p,h,r,d){return a(),e("div",null,i[0]||(i[0]=[t(`<h1 id="signal-pre-processing" tabindex="-1">Signal pre-processing <a class="header-anchor" href="#signal-pre-processing" aria-label="Permalink to &quot;Signal pre-processing&quot;">​</a></h1><p>The <code>PreProcessSignals</code> module provides preprocessing functions for cleaning sEMG signals prior to their use in feature extraction. Signal processing is broken into 3 parts: notch filtering, bandpass filtering and smoothing. Each part has additional functions that support more specific needs, explained in more detail in the module descriptions.</p><hr><h2 id="emg2psd" tabindex="-1"><code>EMG2PSD</code> <a class="header-anchor" href="#emg2psd" aria-label="Permalink to &quot;\`EMG2PSD\`&quot;">​</a></h2><h3 id="description" tabindex="-1">Description <a class="header-anchor" href="#description" aria-label="Permalink to &quot;Description&quot;">​</a></h3><p>Creates a PSD (power spectrum density) of a Signal. Uses the Welch method, meaning it can be used as a Long Term Average Spectrum (LTAS).</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EMG2PSD(Sig_vals, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">normalize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;Parameters&quot;">​</a></h3><p><code>Sig_vals</code>: float list</p><ul><li>A list of float values. A column of a Signal.</li></ul><p><code>sr</code>: int/float (1000)</p><ul><li>Numerical value of the sampling rate of the <code>Signal</code>. This is the number of entries recorded per second, or the inverse of the difference in time between entries.</li></ul><p><code>normalize</code>: bool (True)</p><ul><li>Normalizes the result of the PSD by its maximum strength.</li></ul><h3 id="returns" tabindex="-1">Returns <a class="header-anchor" href="#returns" aria-label="Permalink to &quot;Returns&quot;">​</a></h3><p><code>EMG2PSD</code>: pd.DataFrame</p><ul><li>Returns a dictionary of frequencies and related strengths with the columns &quot;Frequency&quot; and &quot;Power&quot;.</li></ul><h3 id="error" tabindex="-1">Error <a class="header-anchor" href="#error" aria-label="Permalink to &quot;Error&quot;">​</a></h3><p>Raises an error if the sampling rate is less or equal to 0.</p><h3 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PSD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.EMG2PSD(SignalDF[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;col1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], sr)</span></span></code></pre></div><hr><h2 id="applynotchfilters" tabindex="-1"><code>ApplyNotchFilters</code> <a class="header-anchor" href="#applynotchfilters" aria-label="Permalink to &quot;\`ApplyNotchFilters\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a list of notch filters to a <code>Signal</code>, using the <code>scipy.signal.iirnotch</code> method. Returns a new DataFrame object and does not modify the <code>Signal</code> provided.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyNotchFilters(Signal, col, sampling_rate, notch_vals)</span></span></code></pre></div><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filters are being applied to.</li></ul><p><code>sampling_rate</code>: int/float</p><ul><li>Numerical value of the sampling rate of the <code>Signal</code>. This is the number of entries recorded per second, or the inverse of the difference in time between entries.</li></ul><p><code>notch_vals</code>: tuple list</p><ul><li>List of the notch filters to apply to <code>Signal</code>. A notch value is a <code>(Hz, Q)</code> tuple of the frequency and Q-factor (intensity) to apply.</li></ul><p><strong>Returns</strong></p><p><code>ApplyNotchFilters</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filters applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if the sampling rate is less or equal to 0.</p><p>Raises an error if a value in <code>notch_vals</code> is greater than <code>sampling_rate/2</code> or less than 0.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply a notch filter at 150Hz and Q-score of 5, and at</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 250Hz and a Q-score of 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SignalFiltered </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyNotchFilters(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sr, [(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)])</span></span></code></pre></div><hr><h2 id="notchfiltersignals" tabindex="-1"><code>NotchFilterSignals</code> <a class="header-anchor" href="#notchfiltersignals" aria-label="Permalink to &quot;\`NotchFilterSignals\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies notch filters to all <code>Signal</code> files in a folder. Writes output to a new folder directory, mirroring the file hierarchy of the input.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><p>All files contained within the folder and subfolder with the proper extension are assumed to be <code>Signal</code> files. All <code>Signal</code> files within the folder and subfolders should have the same change in time between entries.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NotchFilterSignals(in_path, out_path, sampling_rate, notch, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expresion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exp_copy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file_ext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Parameters</strong></p><p><code>in_path</code>: str</p><ul><li>String filepath to a directory containing <code>Signal</code> files.</li></ul><p><code>out_path</code>: str</p><ul><li>String filepath to a directory for output <code>Signal</code> files.</li></ul><p><code>sampling_rate</code>: int/float</p><ul><li>Numerical value of the sampling rate of the <code>Signal</code>. This is the number of entries recorded per second, or the inverse of the difference in time between entries.</li></ul><p><code>notch</code>: tuple list</p><ul><li>List of the notch filters to apply to <code>Signal</code>. A notch value is a <code>(Hz, Q)</code> tuple of the frequency and Q-factor (intensity) to apply.</li></ul><p><code>cols</code>: str (None)</p><ul><li>List of string column names. If provided, will only apply filters to specified columns. If left <code>None</code>, will apply filters to each column except for the <code>&#39;Time&#39;</code> column.</li></ul><p><code>expression</code>: str (None)</p><ul><li>String regular expression. If provided, will only apply filters to <code>Signal</code> files whose names match the regular expression, and will ignore everything else.</li></ul><p><code>exp_copy</code>: bool (False)</p><ul><li>If <code>True</code>, will copy <code>Signals</code> that don&#39;t match <code>expression</code> without modifying them to <code>out_path</code>. If <code>False</code>, <code>Signal</code> files that don&#39;t match <code>expression</code> will not appear in <code>out_path</code>.</li></ul><p><code>file_ext</code>: str (&quot;csv&quot;)</p><ul><li>String extension of the files to read. Any file in <code>in_path</code> with this extension will be considered to be a <code>Signal</code> file, and treated as such. The default is <code>&#39;csv&#39;</code>.</li></ul><p><strong>Returns</strong></p><p><code>NotchFilterSignals</code>: None</p><ul><li>Does not return a value. Data is written to <code>out_path</code>. Data written will be identical to input <code>Signal</code> files, but with different values for the filter applied.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in any of the Signal files found.</p><p>Raises an error if the sampling rate is less or equal to 0.</p><p>Raises an error if a value in <code>notch_vals</code> is greater than <code>sampling_rate/2</code> or less than 0.</p><p>Raises a warning if <code>expression</code> causes all files to be filtered out.</p><p>Raises an error if a file cannot be read in <code>in_path</code>.</p><p>Raises an error if an unsupported file format was provided for <code>file_ext</code>.</p><p>Raises an error if <code>expression</code> is not a valid regular expression.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">raw_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/raw&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">notch_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/notch&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sampling_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">notch_vals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Special case parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">notch_spec </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/notch2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">notch_vals_spec </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">317</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">reg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;^(08|11)&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_zyg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_cor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply notch_vals filters to all files in raw_path,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># and write them to notch_path</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EMGFlow.NotchFilterSignals(raw_path, notch_path, sampling_rate, notch_vals, cols)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply an additional special case filter to files beginning</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># with &#39;08&#39; or &#39;11&#39;, and write them to notch_spec, making</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sure to copy the other files as well</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EMGFlow.NotchFilterSignals(notch_path, notch_spec, sampling_rate, notch_vals_spec, cols, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exp_copy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><hr><h2 id="applybandpassfilter" tabindex="-1"><code>ApplyBandpassFilter</code> <a class="header-anchor" href="#applybandpassfilter" aria-label="Permalink to &quot;\`ApplyBandpassFilter\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a bandpass filter to a <code>Signal</code>, using the <code>scipy.signal.lfilter</code> method. Returns a new Pandas DataFrame object and does not modify the <code>Signal</code> provided.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyBandpassFilter(Signal, col, sampling_rate, low, high)</span></span></code></pre></div><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filters are being applied to.</li></ul><p><code>sampling_rate</code>: int/float</p><ul><li>Numerical value of the sampling rate of the <code>Signal</code>. This is the number of entries recorded per second, or the inverse of the difference in time between entries.</li></ul><p><code>low</code>: int/float (20)</p><ul><li>Numerical value of the lower limit of the bandpass filter. Defaults to 20Hz.</li></ul><p><code>high</code>: int/float (450)</p><ul><li>Numerical value of the upper limit of the bandpass filter. Defaults to 450Hz.</li></ul><p><strong>Returns</strong></p><p><code>ApplyBandpassFilter</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filters applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if the sampling rate is less or equal to 0.</p><p>Raises an error if <code>high</code> is not higher than <code>low</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply a notch filter from 20Hz to 250Hz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SignalFiltered </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyNotchFilters(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sr, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><hr><h2 id="bandpassfiltersignals" tabindex="-1"><code>BandpassFilterSignals</code> <a class="header-anchor" href="#bandpassfiltersignals" aria-label="Permalink to &quot;\`BandpassFilterSignals\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a bandpass filter to all <code>Signal</code> files in a folder. Writes output to a new folder directory, mirroring the file hierarchy of the input.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><p>All files contained within the folder and subfolder with the proper extension are assumed to be <code>Signal</code> files. All <code>Signal</code> files within the folder and subfolders should have the same change in time between entries.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BandpassFilterSignals(in_path, out_path, sampling_rate, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">low</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">high</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">450</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expression</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exp_copy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file_ext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Theory</strong></p><p>The <code>low</code> and <code>high</code> parameters default to 20Hz and 450Hz respectively, as research suggests this is a good range for EMG signals. The journal &quot;Filtering the surface EMG signal: Moving artifact and baseline noise contamination&quot; suggests using values if 15-28Hz for the lower threshold, and 400-450Hz for the upper threshold.</p><p>These values can also be set manually for specific needs. There is some disagreement in documentation, suggesting other values may be better for some cases.</p><p><strong>Parameters</strong></p><p><code>in_path</code>: str</p><ul><li>String filepath to a directory containing <code>Signal</code> files.</li></ul><p><code>out_path</code>: str</p><ul><li>String filepath to a directory for output <code>Signal</code> files.</li></ul><p><code>sampling_rate</code>: int/float</p><ul><li>Numerical value of the sampling rate of the <code>Signal</code>. This is the number of entries recorded per second, or the inverse of the difference in time between entries.</li></ul><p><code>low</code>: int/float (20)</p><ul><li>Numerical value of the lower limit of the bandpass filter.</li></ul><p><code>high</code>: int/float (450)</p><ul><li>Numerical value of the upper limit of the bandpass filter.</li></ul><p><code>cols</code>: str (None)</p><ul><li>List of string column names. If provided, will only apply filters to specified columns. If left <code>None</code>, will apply filters to each column except for the <code>&#39;Time&#39;</code> column.</li></ul><p><code>expression</code>: str (None)</p><ul><li>String regular expression. If provided, will only apply filters to <code>Signal</code> files whose names match the regular expression, and will ignore everything else.</li></ul><p><code>exp_copy</code>: bool (False)</p><ul><li>If <code>True</code>, will copy <code>Signals</code> that don&#39;t match <code>expression</code> without modifying them to <code>out_path</code>. If <code>False</code>, <code>Signal</code> files that don&#39;t match <code>expression</code> will not appear in <code>out_path</code>.</li></ul><p><code>file_ext</code>: str (&quot;csv&quot;)</p><ul><li>String extension of the files to read. Any file in <code>in_path</code> with this extension will be considered to be a <code>Signal</code> file, and treated as such. The default is <code>&#39;csv&#39;</code>.</li></ul><p><strong>Returns</strong></p><p><code>BandpassFilterSignals</code>: None</p><ul><li>Does not return a value. Data is written to <code>out_path</code>. Data written will be identical to input <code>Signal</code> files, but with different values for the filter applied.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in any of the Signal files found.</p><p>Raises an error if the sampling rate is less or equal to 0.</p><p>Raises a warning if <code>expression</code> causes all files to be filtered out.</p><p>Raises an error if <code>high</code> is not higher than <code>low</code>.</p><p>Raises an error if a file cannot be read in <code>in_path</code>.</p><p>Raises an error if an unsupported file format was provided for <code>file_ext</code>.</p><p>Raises an error if <code>expression</code> is not a valid regular expression.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">notch_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/notch&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bandpass_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/bandpass&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sampling_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">low </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">high </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_zyg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_cor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply notch_vals filters to all files in notch_path,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># and write them to bandpass_path</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EMGFlow.BandpassFilterSignals(notch_path, bandpass_path, sampling_rate, low, high, cols)</span></span></code></pre></div><hr><h2 id="applyfwr" tabindex="-1"><code>ApplyFWR</code> <a class="header-anchor" href="#applyfwr" aria-label="Permalink to &quot;\`ApplyFWR\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a Full Wave Rectifier (FWR) to a <code>Signal</code></p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyFWR(Signal, col)</span></span></code></pre></div><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filter is being applied to.</li></ul><p><strong>Returns</strong></p><p><code>ApplyFWR</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filter applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FWR_DF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyFWR(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><hr><h2 id="applyboxcarsmooth" tabindex="-1"><code>ApplyBoxcarSmooth</code> <a class="header-anchor" href="#applyboxcarsmooth" aria-label="Permalink to &quot;\`ApplyBoxcarSmooth\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a boxcar smoothing filter to the <code>Signal</code>. Applies a simple unweighted average.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyBoxcarSmooth(Signal, col, window_size)</span></span></code></pre></div><p><strong>Theory</strong></p><p>For a window size $\\mu$, the boxcar smoothing algorithm is:</p><div class="language-math vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">math</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>s\\\\_i=\\frac{\\sum\\\\_{j=i-\\mu}^{i+\\mu}x\\\\_j}{2\\mu+1}</span></span></code></pre></div><p>(O’Haver, 2023)</p><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filter is being applied to.</li></ul><p><code>window_size</code>: int</p><ul><li>Size of the window in the smoothing filter.</li></ul><p><strong>Returns</strong></p><p><code>ApplyBoxcarSmooth</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filter applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if <code>window_size</code> is less or equal to 0.</p><p>Raises a warning if <code>window_size</code> is greater than the length of <code>Signal</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SmoothDF </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyBoxCarSmooth(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, width)</span></span></code></pre></div><hr><h2 id="applyrmssmooth" tabindex="-1"><code>ApplyRMSSmooth</code> <a class="header-anchor" href="#applyrmssmooth" aria-label="Permalink to &quot;\`ApplyRMSSmooth\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a Root Mean Squared (RMS) smoothing filter to the <code>Signal</code>. Takes the average of a window around each point.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyRMSSmooth(Signal, col, window_size)</span></span></code></pre></div><p><strong>Theory</strong></p><p>For a window size $\\mu$, the RMS smoothing algorithm is:</p><div class="language-math vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">math</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>s\\\\_i=\\sqrt{\\frac{\\sum\\\\_{j=i-\\mu}^{i+\\mu}x\\\\_j^2}{2\\mu+1}}</span></span></code></pre></div><p>(Dwivedi et al., 2023)</p><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filter is being applied to.</li></ul><p><code>window_size</code>: int</p><ul><li>Size of the window in the smoothing filter.</li></ul><p><strong>Returns</strong></p><p><code>ApplyRMSSmooth</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filter applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if <code>window_size</code> is less or equal to 0.</p><p>Raises a warning if <code>window_size</code> is greater than the length of <code>Signal</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SmoothDF </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyRMSSmooth(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, width)</span></span></code></pre></div><hr><h2 id="applygaussiansmooth" tabindex="-1"><code>ApplyGaussianSmooth</code> <a class="header-anchor" href="#applygaussiansmooth" aria-label="Permalink to &quot;\`ApplyGaussianSmooth\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a Root Mean Squared (RMS) smoothing filter to the <code>Signal</code>. Applies a Gaussian weighted average.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyGaussianSmooth(Signal, col, window_size, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Theory</strong></p><p>For a window size $\\mu$, the Gaussian smoothing algorithm is:</p><div class="language-math vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">math</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>s\\\\_j=\\sum\\\\_{i=j-\\mu}^{j+\\mu}\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{(\\mu-i)^2}{2\\sigma^2}}</span></span></code></pre></div><ul><li>$\\sigma$ is the standard deviation parameter we want to look at</li></ul><p>(Fisher et al., 2003)</p><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filter is being applied to.</li></ul><p><code>window_size</code>: int</p><ul><li>Size of the window in the smoothing filter.</li></ul><p><code>sigma</code>: int/float (1)</p><ul><li>Value of sigma in the Gaussian smoothing&#39;s distribution, defaults to 1.</li></ul><p><strong>Returns</strong></p><p><code>ApplyGaussianSmooth</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filter applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if <code>window_size</code> is less or equal to 0.</p><p>Raises a warning if <code>window_size</code> is greater than the length of <code>Signal</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SmoothDF </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyGaussianSmooth(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, width)</span></span></code></pre></div><hr><h2 id="applyloesssmooth" tabindex="-1"><code>ApplyLoessSmooth</code> <a class="header-anchor" href="#applyloesssmooth" aria-label="Permalink to &quot;\`ApplyLoessSmooth\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a Loess smoothing filter to the <code>Signal</code>. Applies a tricubic weighted average.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ApplyLoessSmooth(Signal, col, window_size)</span></span></code></pre></div><p><strong>Theory</strong></p><p>For a window size $\\mu$, the Loess smoothing algorithm is:</p><div class="language-math vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">math</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>s\\\\_j=\\sum\\\\_{i=j-\\mu}^{j+\\mu}w\\\\_ix\\\\_i</span></span></code></pre></div><div class="language-math vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">math</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>w\\\\_i=\\left(1-\\left(\\frac{d\\\\_i}{\\max(d\\\\_i)}\\right)^3\\right)^3</span></span></code></pre></div><ul><li>$d$ represents a series of evenly spaced numbers such that $-1\\lt d_i\\lt 1$</li></ul><p>(Figueira, 2021)</p><p><strong>Parameters</strong></p><p><code>Signal</code>: pd.DataFrame</p><ul><li>Should have one column called &quot;<code>Time</code>&quot; for the time indexes, and other named columns for the values at those times.</li></ul><p><code>col</code>: str</p><ul><li>String name of a column in <code>Signal</code> the filter is being applied to.</li></ul><p><code>window_size</code>: int</p><ul><li>Size of the window in the smoothing filter.</li></ul><p><strong>Returns</strong></p><p><code>ApplyLoessSmooth</code>: pd.DataFrame</p><ul><li>Returns a <code>Signal</code> DataFrame identical to the input, but with the corresponding filter applied to the correct column.</li></ul><p><strong>Error</strong></p><p>Raises an error if <code>col</code> is not found in <code>Signal</code>.</p><p>Raises an error if <code>window_size</code> is less or equal to 0.</p><p>Raises a warning if <code>window_size</code> is greater than the length of <code>Signal</code>.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SmoothDF </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EMGFlow.ApplyLoessSmooth(SignalDF, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;column1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, width)</span></span></code></pre></div><hr><h2 id="smoothfiltersignals" tabindex="-1"><code>SmoothFilterSignals</code> <a class="header-anchor" href="#smoothfiltersignals" aria-label="Permalink to &quot;\`SmoothFilterSignals\`&quot;">​</a></h2><p><strong>Description</strong></p><p>Applies a smoothing filter to all <code>Signal</code> files in a folder. Writes output to a new folder directory, mirroring the file hierarchy of the input.</p><p>Components of a &quot;<code>Signal</code> file&quot;:</p><ul><li>Has a column named <code>Time</code> containing time indexes</li><li><code>Time</code> indexes are all equally spaced apart</li><li>Has one (or more) columns with any other name, holding the value of the electrical signal read at that time</li></ul><p>All files contained within the folder and subfolder with the proper extension are assumed to be <code>Signal</code> files. All <code>Signal</code> files within the folder and subfolders should have the same change in time between entries.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SmoothFilterSignals(in_path, out_path, window_size, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expression</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exp_copy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file_ext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;rms&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Theory</strong></p><p>By default, the <code>SmoothFilterSignals</code> function uses the RMS smoothing method. This is because for EMG signals, RMS smoothing is considered to be the best method (RENSHAW et al., 2010).</p><p>Other smoothing functions are also available for use if needed.</p><p><strong>Parameters</strong></p><p><code>in_path</code>: str</p><ul><li>String filepath to a directory containing <code>Signal</code> files.</li></ul><p><code>out_path</code>: str</p><ul><li>String filepath to a directory for output <code>Signal</code> files.</li></ul><p><code>window_size</code>: int</p><ul><li>Size of the window in the smoothing filter.</li></ul><p><code>cols</code>: str (None)</p><ul><li>List of string column names. If provided, will only apply filters to specified columns. If left <code>None</code>, will apply filters to each column except for the <code>&#39;Time&#39;</code> column.</li></ul><p><code>expression</code>: str (None)</p><ul><li>String regular expression. If provided, will only apply filters to <code>Signal</code> files whose names match the regular expression, and will ignore everything else.</li></ul><p><code>exp_copy</code>: bool (False)</p><ul><li>If <code>True</code>, will copy <code>Signals</code> that don&#39;t match <code>expression</code> without modifying them to <code>out_path</code>. If <code>False</code>, <code>Signal</code> files that don&#39;t match <code>expression</code> will not appear in <code>out_path</code>.</li></ul><p><code>file_ext</code>: str (&quot;csv&quot;)</p><ul><li>String extension of the files to read. Any file in <code>in_path</code> with this extension will be considered to be a <code>Signal</code> file, and treated as such. The default is <code>&#39;csv&#39;</code>.</li></ul><p><code>method</code>: str (&quot;rms&quot;)</p><ul><li>Smoothing method to be used. Defaults to &quot;rms&quot;, but can also be set to &quot;boxcar, &quot;gauss&quot; or &quot;loess&quot;.</li></ul><p><code>sigma</code>: float (1)</p><ul><li>Value of <code>sigma</code> used with a Gaussian filter. Only affects output when using a Gaussian filter.</li></ul><p><strong>Returns</strong></p><p><code>SmoothFilterSignals</code>: None</p><ul><li>Does not return a value. Data is written to <code>out_path</code>. Data written will be identical to input <code>Signal</code> files, but with different values for the filter applied.</li></ul><p><strong>Error</strong></p><p>Raises an error if an invalid smoothing method is passed to <code>method</code>.</p><p>Raises an error if any of the Signal files don&#39;t contain a column listed in <code>cols</code>.</p><p>Raises an error if <code>window_size</code> is less or equal to 0.</p><p>Raises a warning if <code>expression</code> causes all files to be filtered out.</p><p>Raises a warning if <code>window_size</code> is greater than the length of <code>Signal</code>.</p><p>Raises an error if a file cannot be read in <code>in_path</code>.</p><p>Raises an error if an unsupported file format was provided for <code>file_ext</code>.</p><p>Raises an error if <code>expression</code> is not a valid regular expression.</p><p><strong>Example</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bandpass_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/bandpass&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">smooth_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/data/smooth&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_zyg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EMG_cor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply smoothing filter with window size 20 to all files in</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># bandpass_path, and write them to smooth_path</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EMGFlow.SmoothFilterSignals(bandpass_path, smooth_path, size, cols)</span></span></code></pre></div><hr><h2 id="sources" tabindex="-1">Sources <a class="header-anchor" href="#sources" aria-label="Permalink to &quot;Sources&quot;">​</a></h2><p>Dwivedi, D., Ganguly, A., &amp; Haragopal, V. V. (2023). Contrast between simple and complex classification algorithms. In T. Goswami &amp; G. R. Sinha (Eds.), <em>Statistical Modeling in Machine Learning</em> (pp. 93–110). Academic Press. <a href="https://doi.org/10.1016/B978-0-323-91776-6.00016-6" target="_blank" rel="noreferrer">https://doi.org/10.1016/B978-0-323-91776-6.00016-6</a></p><p>Figueira, J. P. (2021, June 1). <em>LOESS</em>. Medium. <a href="https://towardsdatascience.com/loess-373d43b03564" target="_blank" rel="noreferrer">https://towardsdatascience.com/loess-373d43b03564</a></p><p>Fisher, R., Perkins, S., Walker, A., &amp; Wolfart, E. (2003). <em>Gaussian Smoothing</em>. <a href="https://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm" target="_blank" rel="noreferrer">https://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm</a></p><p>O’Haver, T. (2023, April). <em>A Pragmatic Introduction to Signal Processing: Smoothing</em>. <a href="https://terpconnect.umd.edu/~toh/spectrum/Smoothing.html" target="_blank" rel="noreferrer">https://terpconnect.umd.edu/~toh/spectrum/Smoothing.html</a></p><p>RENSHAW, D., BICE, M. R., CASSIDY, C., ELDRIDGE, J. A., &amp; POWELL, D. W. (2010). A Comparison of Three Computer-based Methods Used to Determine EMG Signal Amplitude. <em>International Journal of Exercise Science</em>, <em>3</em>(1), 43–48.</p>`,337)]))}const k=s(n,[["render",l]]);export{g as __pageData,k as default};
